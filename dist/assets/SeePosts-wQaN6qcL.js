import{r,b as w,j as s}from"./index-pdw-_P6u.js";import{a as c}from"./axios-x9P0maA2.js";import{Q as v,B as x}from"./react-toastify.esm-VxyaM7rW.js";const E=()=>{const[a,l]=r.useState([]),[b,h]=r.useState(!0),[g,i]=r.useState(null),[n,f]=r.useState(null),[o,u]=r.useState(""),p=localStorage.getItem("email"),{authUser:m}=w();r.useEffect(()=>{(async()=>{try{const t=await c.get("https://backend-pdfchatarif.onrender.com/posts");l(t.data),h(!1)}catch{i("Error fetching posts"),h(!1)}})()},[]);const j=e=>{f(n===e?null:e)},N=async e=>{if(!m){x.error("Please login to like the post!");return}try{await c.post(`https://backend-pdfchatarif.onrender.com/posts/${e}/like`),l(a.map(t=>t._id===e?{...t,likes:t.likes+1}:t))}catch{i("Error liking post")}},y=async e=>{if(!m){x.error("Please login to dislike the post!");return}try{await c.post(`https://backend-pdfchatarif.onrender.com/posts/${e}/dislike`),l(a.map(t=>t._id===e?{...t,dislikes:t.dislikes+1}:t))}catch{i("Error disliking post")}},k=async e=>{if(!m){x.error("Please login to comment on the post!");return}if(o.trim())try{const t=await c.post(`https://backend-pdfchatarif.onrender.com/posts/${e}/comments`,{text:o});l(a.map(d=>d._id===e?{...d,comments:[...d.comments,t.data]}:d)),u("")}catch{i("Error adding comment")}};return b?s.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading..."}):g?s.jsx("div",{className:"text-red-500 text-center mt-4",children:g}):s.jsxs("div",{className:"bg-gray-100 py-8",children:[s.jsx(v,{}),s.jsxs("div",{className:"max-w-6xl mx-auto p-4 bg-white rounded-lg shadow-md",children:[s.jsx("h1",{className:"text-4xl font-bold mb-12 text-blue-600 text-center",children:"All Posts"}),a.length===0?s.jsx("div",{className:"text-center text-gray-500",children:"No posts available"}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(e=>s.jsxs("div",{className:`p-6 border rounded-lg shadow-lg cursor-pointer transition-transform transform ${n===e._id?"scale-105 z-10 bg-blue-50":"border-gray-300 bg-white"}`,style:{gridColumn:n===e._id?"span 3":"span 1",gridRow:n===e._id?"span 3":"span 1"},onClick:t=>{t.target.closest(".expanded-area")||j(e._id)},children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx("img",{src:e.authorprofilepicture,alt:e.authorname,className:"w-16 h-16 rounded-full border border-gray-300 mr-4"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:e.title}),s.jsxs("p",{className:"text-gray-600",children:["By ",e.authorname]})]})]}),e.cover&&s.jsx("img",{src:e.cover,alt:e.title,className:"mb-4 w-full h-40 object-cover rounded-lg shadow-sm"}),n===e._id&&s.jsxs("div",{className:"expanded-area",children:[s.jsx("p",{className:"text-gray-900 mb-4",children:e.summary}),s.jsx("div",{className:"prose prose-blue",dangerouslySetInnerHTML:{__html:e.content}}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("button",{onClick:()=>N(e._id),className:"mr-4 bg-blue-700 text-white py-2 px-4 rounded-lg",children:["Like (",e.likes,")"]}),s.jsxs("button",{onClick:()=>y(e._id),className:"bg-red-700 text-white py-2 px-4 rounded-lg",children:["Dislike (",e.dislikes,")"]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-semibold mt-6",children:"Comments"}),s.jsx("ul",{className:"mt-4 space-y-4",children:e.comments.map(t=>s.jsxs("li",{className:"border-b pb-2",children:[s.jsxs("p",{children:[s.jsxs("strong",{children:[p,":"]})," ",t.text]}),s.jsx("p",{className:"text-gray-500 text-sm",children:new Date(t.date).toLocaleString()})]},t._id))}),s.jsxs("div",{className:"mt-4",children:[s.jsx("textarea",{value:o,onChange:t=>u(t.target.value),className:"w-full p-2 border rounded-lg",rows:"3",placeholder:"Add a comment..."}),s.jsx("button",{onClick:t=>{t.stopPropagation(),k(e._id)},className:"mt-2 bg-green-500 text-white py-2 px-4 rounded-lg",children:"Submit"})]})]})]})]})]},e._id))})]})]})};export{E as default};
